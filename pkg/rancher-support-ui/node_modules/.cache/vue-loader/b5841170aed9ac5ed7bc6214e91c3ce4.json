{"remainingRequest":"/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/pkg/rancher-support-ui/detail/ranchersupportbundle.rancher.cattle.io.ranchersupportbundle.vue?vue&type=style&index=0&id=4bc283e1&prod&lang=scss&scoped=true","dependencies":[{"path":"/app/pkg/rancher-support-ui/detail/ranchersupportbundle.rancher.cattle.io.ranchersupportbundle.vue","mtime":1764053445255},{"path":"/app/node_modules/css-loader/dist/cjs.js","mtime":1764051452114},{"path":"/app/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1764051466085},{"path":"/app/node_modules/postcss-loader/src/index.js","mtime":1764051466637},{"path":"/app/node_modules/postcss-loader/src/index.js","mtime":1764051466637},{"path":"/app/node_modules/sass-loader/dist/cjs.js","mtime":1764051449867},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1764051466330},{"path":"/app/node_modules/vue-loader/lib/index.js","mtime":1764051466085}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5sYWJlbGVkLWlucHV0IHsKICBsYWJlbCB7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgbWFyZ2luLWJvdHRvbTogNXB4OwogIH0KICBkaXYgewogICAgcGFkZGluZzogMTBweDsKICAgIGJhY2tncm91bmQ6IHZhcigtLWlucHV0LWJnKTsKICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWlucHV0LWJvcmRlcik7CiAgICBib3JkZXItcmFkaXVzOiAzcHg7CiAgfQp9Cg=="},{"version":3,"sources":["ranchersupportbundle.rancher.cattle.io.ranchersupportbundle.vue"],"names":[],"mappings":";AAoHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ranchersupportbundle.rancher.cattle.io.ranchersupportbundle.vue","sourceRoot":"detail","sourcesContent":["<script>\nimport ResourceTabs from '@shell/components/form/ResourceTabs';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport SortableTable from '@shell/components/SortableTable';\nimport { Banner } from '@components/Banner';\n\nexport default {\n  name: 'DetailRancherSupportBundle',\n  components: {\n    ResourceTabs,\n    Tab,\n    SortableTable,\n    Banner,\n  },\n  props: {\n    value: {\n      type: Object,\n      required: true,\n    },\n  },\n  computed: {\n    clustersHeaders() {\n      return [\n        {\n          name: 'cluster',\n          labelKey: 'tableHeaders.cluster',\n          value: 'cluster',\n        },\n      ];\n    },\n    clustersRows() {\n      return (this.value.spec.clusters || []).map(cluster => ({ cluster }));\n    },\n    canDownload() {\n      return this.value.status?.state === 'Completed';\n    },\n    downloadUrl() {\n      // Construct the download URL using Kubernetes API proxy\n      // Format: /k8s/clusters/<cluster-id>/api/v1/namespaces/<namespace>/services/<service-name>:<port>/proxy/bundle.zip\n      const namespace = this.value.metadata.namespace || 'default';\n      const serviceName = `${this.value.metadata.name}-collector`;\n      const clusterId = this.$store.getters['currentCluster']?.id || 'local';\n      \n      return `/k8s/clusters/${clusterId}/api/v1/namespaces/${namespace}/services/${serviceName}:8080/proxy/bundle.zip`;\n    },\n  },\n  methods: {\n    downloadBundle() {\n      if (this.canDownload) {\n        window.location.href = this.downloadUrl;\n      }\n    },\n  },\n};\n</script>\n\n<template>\n  <div>\n    <h2>{{ value.metadata.name }}</h2>\n    \n    <div class=\"row mb-20\">\n      <div class=\"col span-12\">\n        <Banner\n          v-if=\"value.status?.message\"\n          :color=\"value.status.state === 'Failed' ? 'error' : 'info'\"\n        >\n          {{ value.status.message }}\n        </Banner>\n      </div>\n    </div>\n\n    <div class=\"row mb-20\">\n      <div class=\"col span-6\">\n        <div class=\"labeled-input\">\n          <label>{{ t('rancherSupportBundle.state.label') }}</label>\n          <div>{{ value.status?.state || 'Pending' }}</div>\n        </div>\n      </div>\n      <div class=\"col span-6\">\n        <div class=\"labeled-input\">\n          <label>{{ t('rancherSupportBundle.storageClassName.label') }}</label>\n          <div>{{ value.spec?.storageClassName || 'N/A' }}</div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"row mb-20\">\n      <div class=\"col span-12\">\n        <button\n          :disabled=\"!canDownload\"\n          class=\"btn role-primary\"\n          @click=\"downloadBundle\"\n        >\n          {{ t('rancherSupportBundle.download.label') }}\n        </button>\n        <span v-if=\"!canDownload\" class=\"text-muted ml-10\">\n          {{ t('rancherSupportBundle.download.notReady') }}\n        </span>\n      </div>\n    </div>\n\n    <ResourceTabs v-model=\"value\" :mode=\"'view'\">\n      <Tab name=\"clusters\" :label=\"t('rancherSupportBundle.clusters.label')\">\n        <SortableTable\n          :rows=\"clustersRows\"\n          :headers=\"clustersHeaders\"\n          key-field=\"cluster\"\n          :search=\"false\"\n          :paging=\"false\"\n        />\n      </Tab>\n    </ResourceTabs>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.labeled-input {\n  label {\n    display: block;\n    font-weight: bold;\n    margin-bottom: 5px;\n  }\n  div {\n    padding: 10px;\n    background: var(--input-bg);\n    border: 1px solid var(--input-border);\n    border-radius: 3px;\n  }\n}\n</style>\n"]}]}
{"remainingRequest":"/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/pkg/rancher-support-ui/detail/ranchersupportbundle.rancher.cattle.io.ranchersupportbundle.vue?vue&type=script&lang=js","dependencies":[{"path":"/app/pkg/rancher-support-ui/detail/ranchersupportbundle.rancher.cattle.io.ranchersupportbundle.vue","mtime":1764056447687},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":1764054258910},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1764054259024},{"path":"/app/node_modules/vue-loader/lib/index.js","mtime":1764054260995}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBSZXNvdXJjZVRhYnMgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9SZXNvdXJjZVRhYnMnOwppbXBvcnQgVGFiIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1RhYmJlZC9UYWInOwppbXBvcnQgU29ydGFibGVUYWJsZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Tb3J0YWJsZVRhYmxlJzsKaW1wb3J0IEJhbm5lciBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9CYW5uZXInOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdEZXRhaWxSYW5jaGVyU3VwcG9ydEJ1bmRsZScsCiAgY29tcG9uZW50czogewogICAgUmVzb3VyY2VUYWJzLAogICAgVGFiLAogICAgU29ydGFibGVUYWJsZSwKICAgIEJhbm5lciwKICB9LAogIHByb3BzOiB7CiAgICB2YWx1ZTogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgfSwKICB9LAogIGNvbXB1dGVkOiB7CiAgICBjbHVzdGVyc0hlYWRlcnMoKSB7CiAgICAgIHJldHVybiBbCiAgICAgICAgewogICAgICAgICAgbmFtZTogJ2NsdXN0ZXInLAogICAgICAgICAgbGFiZWxLZXk6ICd0YWJsZUhlYWRlcnMuY2x1c3RlcicsCiAgICAgICAgICB2YWx1ZTogJ2NsdXN0ZXInLAogICAgICAgIH0sCiAgICAgIF07CiAgICB9LAogICAgY2x1c3RlcnNSb3dzKCkgewogICAgICByZXR1cm4gKHRoaXMudmFsdWUuc3BlYy5jbHVzdGVycyB8fCBbXSkubWFwKGNsdXN0ZXIgPT4gKHsgY2x1c3RlciB9KSk7CiAgICB9LAogICAgY2FuRG93bmxvYWQoKSB7CiAgICAgIHJldHVybiB0aGlzLnZhbHVlLnN0YXR1cz8uc3RhdGUgPT09ICdDb21wbGV0ZWQnOwogICAgfSwKICAgIGRvd25sb2FkVXJsKCkgewogICAgICAvLyBDb25zdHJ1Y3QgdGhlIGRvd25sb2FkIFVSTCB1c2luZyBLdWJlcm5ldGVzIEFQSSBwcm94eQogICAgICAvLyBGb3JtYXQ6IC9rOHMvY2x1c3RlcnMvPGNsdXN0ZXItaWQ+L2FwaS92MS9uYW1lc3BhY2VzLzxuYW1lc3BhY2U+L3NlcnZpY2VzLzxzZXJ2aWNlLW5hbWU+Ojxwb3J0Pi9wcm94eS9idW5kbGUuemlwCiAgICAgIGNvbnN0IG5hbWVzcGFjZSA9IHRoaXMudmFsdWUubWV0YWRhdGEubmFtZXNwYWNlIHx8ICdkZWZhdWx0JzsKICAgICAgY29uc3Qgc2VydmljZU5hbWUgPSBgJHt0aGlzLnZhbHVlLm1ldGFkYXRhLm5hbWV9LWNvbGxlY3RvcmA7CiAgICAgIGNvbnN0IGNsdXN0ZXJJZCA9IHRoaXMuJHN0b3JlLmdldHRlcnNbJ2N1cnJlbnRDbHVzdGVyJ10/LmlkIHx8ICdsb2NhbCc7CiAgICAgIAogICAgICByZXR1cm4gYC9rOHMvY2x1c3RlcnMvJHtjbHVzdGVySWR9L2FwaS92MS9uYW1lc3BhY2VzLyR7bmFtZXNwYWNlfS9zZXJ2aWNlcy8ke3NlcnZpY2VOYW1lfTo4MDgwL3Byb3h5L2J1bmRsZS56aXBgOwogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIGRvd25sb2FkQnVuZGxlKCkgewogICAgICBpZiAodGhpcy5jYW5Eb3dubG9hZCkgewogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdGhpcy5kb3dubG9hZFVybDsKICAgICAgfQogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["ranchersupportbundle.rancher.cattle.io.ranchersupportbundle.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ranchersupportbundle.rancher.cattle.io.ranchersupportbundle.vue","sourceRoot":"detail","sourcesContent":["<script>\nimport ResourceTabs from '@shell/components/form/ResourceTabs';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport SortableTable from '@shell/components/SortableTable';\nimport Banner from '@shell/components/Banner';\n\nexport default {\n  name: 'DetailRancherSupportBundle',\n  components: {\n    ResourceTabs,\n    Tab,\n    SortableTable,\n    Banner,\n  },\n  props: {\n    value: {\n      type: Object,\n      required: true,\n    },\n  },\n  computed: {\n    clustersHeaders() {\n      return [\n        {\n          name: 'cluster',\n          labelKey: 'tableHeaders.cluster',\n          value: 'cluster',\n        },\n      ];\n    },\n    clustersRows() {\n      return (this.value.spec.clusters || []).map(cluster => ({ cluster }));\n    },\n    canDownload() {\n      return this.value.status?.state === 'Completed';\n    },\n    downloadUrl() {\n      // Construct the download URL using Kubernetes API proxy\n      // Format: /k8s/clusters/<cluster-id>/api/v1/namespaces/<namespace>/services/<service-name>:<port>/proxy/bundle.zip\n      const namespace = this.value.metadata.namespace || 'default';\n      const serviceName = `${this.value.metadata.name}-collector`;\n      const clusterId = this.$store.getters['currentCluster']?.id || 'local';\n      \n      return `/k8s/clusters/${clusterId}/api/v1/namespaces/${namespace}/services/${serviceName}:8080/proxy/bundle.zip`;\n    },\n  },\n  methods: {\n    downloadBundle() {\n      if (this.canDownload) {\n        window.location.href = this.downloadUrl;\n      }\n    },\n  },\n};\n</script>\n\n<template>\n  <div>\n    <h2>{{ value.metadata.name }}</h2>\n    \n    <div class=\"row mb-20\">\n      <div class=\"col span-12\">\n        <Banner\n          v-if=\"value.status?.message\"\n          :color=\"value.status.state === 'Failed' ? 'error' : 'info'\"\n        >\n          {{ value.status.message }}\n        </Banner>\n      </div>\n    </div>\n\n    <div class=\"row mb-20\">\n      <div class=\"col span-6\">\n        <div class=\"labeled-input\">\n          <label>{{ t('rancherSupportBundle.state.label') }}</label>\n          <div>{{ value.status?.state || 'Pending' }}</div>\n        </div>\n      </div>\n      <div class=\"col span-6\">\n        <div class=\"labeled-input\">\n          <label>{{ t('rancherSupportBundle.storageClassName.label') }}</label>\n          <div>{{ value.spec?.storageClassName || 'N/A' }}</div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"row mb-20\">\n      <div class=\"col span-12\">\n        <button\n          :disabled=\"!canDownload\"\n          class=\"btn role-primary\"\n          @click=\"downloadBundle\"\n        >\n          {{ t('rancherSupportBundle.download.label') }}\n        </button>\n        <span v-if=\"!canDownload\" class=\"text-muted ml-10\">\n          {{ t('rancherSupportBundle.download.notReady') }}\n        </span>\n      </div>\n    </div>\n\n    <ResourceTabs v-model=\"value\" :mode=\"'view'\">\n      <Tab name=\"clusters\" :label=\"t('rancherSupportBundle.clusters.label')\">\n        <SortableTable\n          :rows=\"clustersRows\"\n          :headers=\"clustersHeaders\"\n          key-field=\"cluster\"\n          :search=\"false\"\n          :paging=\"false\"\n        />\n      </Tab>\n    </ResourceTabs>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.labeled-input {\n  label {\n    display: block;\n    font-weight: bold;\n    margin-bottom: 5px;\n  }\n  div {\n    padding: 10px;\n    background: var(--input-bg);\n    border: 1px solid var(--input-border);\n    border-radius: 3px;\n  }\n}\n</style>\n"]}]}
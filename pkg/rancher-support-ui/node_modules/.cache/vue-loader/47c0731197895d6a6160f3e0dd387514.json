{"remainingRequest":"/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/node_modules/@rancher/shell/components/ResourceYaml.vue?vue&type=script&lang=js","dependencies":[{"path":"/app/node_modules/@rancher/shell/components/ResourceYaml.vue","mtime":1764054237091},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1764054259024},{"path":"/app/node_modules/thread-loader/dist/cjs.js","mtime":1764054259111},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":1764054258910},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1764054259024},{"path":"/app/node_modules/vue-loader/lib/index.js","mtime":1764054260995}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBqc3lhbWwgZnJvbSAnanMteWFtbCc7CmltcG9ydCBZYW1sRWRpdG9yLCB7IEVESVRPUl9NT0RFUyB9IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1lhbWxFZGl0b3InOwppbXBvcnQgRmlsZVNlbGVjdG9yIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vRmlsZVNlbGVjdG9yJzsKaW1wb3J0IEZvb3RlciBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL0Zvb3Rlcic7CmltcG9ydCB7IEFOTk9UQVRJT05TX1RPX0ZPTEQgfSBmcm9tICdAc2hlbGwvY29uZmlnL2xhYmVscy1hbm5vdGF0aW9ucyc7CmltcG9ydCB7IGVuc3VyZVJlZ2V4IH0gZnJvbSAnQHNoZWxsL3V0aWxzL3N0cmluZyc7CmltcG9ydCB7IHR5cGVPZiB9IGZyb20gJ0BzaGVsbC91dGlscy9zb3J0JzsKCmltcG9ydCB7CiAgX0NSRUFURSwKICBfVklFVywKICBQUkVWSUVXLAogIF9GTEFHR0VELAogIF9VTkZMQUcsCiAgX0VESVQsCn0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwppbXBvcnQgeyBCRUZPUkVfU0FWRV9IT09LUywgQUZURVJfU0FWRV9IT09LUyB9IGZyb20gJ0BzaGVsbC9taXhpbnMvY2hpbGQtaG9vayc7CmltcG9ydCB7IGV4Y2VwdGlvblRvRXJyb3JzQXJyYXkgfSBmcm9tICdAc2hlbGwvdXRpbHMvZXJyb3InOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIEZvb3RlciwKICAgIEZpbGVTZWxlY3RvciwKICAgIFlhbWxFZGl0b3IKICB9LAoKICBwcm9wczogewogICAgbW9kZTogewogICAgICB0eXBlOiAgICAgU3RyaW5nLAogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgIH0sCgogICAgdmFsdWU6IHsKICAgICAgdHlwZTogICAgIE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAoKICAgIGluaXRpYWxZYW1sRm9yRGlmZjogewogICAgICB0eXBlOiAgICBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6IG51bGwsCiAgICB9LAoKICAgIHlhbWw6IHsKICAgICAgdHlwZTogICAgIFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAoKICAgIGRvbmVSb3V0ZTogewogICAgICB0eXBlOiAgICBbU3RyaW5nLCBPYmplY3RdLAogICAgICBkZWZhdWx0OiBudWxsLAogICAgfSwKCiAgICBvZmZlclByZXZpZXc6IHsKICAgICAgdHlwZTogICAgQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZSwKICAgIH0sCgogICAgcGFyZW50UGFyYW1zOiB7CiAgICAgIHR5cGU6ICAgIE9iamVjdCwKICAgICAgZGVmYXVsdDogbnVsbCwKICAgIH0sCgogICAgZG9uZU92ZXJyaWRlOiB7CiAgICAgIHR5cGU6ICAgIFtGdW5jdGlvbiwgT2JqZWN0XSwKICAgICAgZGVmYXVsdDogbnVsbAogICAgfSwKCiAgICBzaG93Rm9vdGVyOiB7CiAgICAgIHR5cGU6ICAgIEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0sCgogICAgYXBwbHlIb29rczogewogICAgICB0eXBlOiAgICBGdW5jdGlvbiwKICAgICAgZGVmYXVsdDogbnVsbCwKICAgIH0KICB9LAoKICBkYXRhKCkgewogICAgLy8gSW5pdGlhbCBsb2FkIHdpdGggYSBwcmV2aWV3IHNob3dpbmcgbm8gZGlmZiBpc24ndCB2ZXJ5IHVzZWZ1bAogICAgdGhpcy4kcm91dGVyLmFwcGx5UXVlcnkoeyBbUFJFVklFV106IF9VTkZMQUcgfSk7CgogICAgcmV0dXJuIHsKICAgICAgaW5pdGlhbFlhbWw6ICB0aGlzLmluaXRpYWxZYW1sRm9yRGlmZiB8fCB0aGlzLnlhbWwsCiAgICAgIGN1cnJlbnRZYW1sOiAgdGhpcy55YW1sLAogICAgICBzaG93UHJldmlldzogIGZhbHNlLAogICAgICBlcnJvcnM6ICAgICAgIG51bGwsCiAgICAgIGNtOiAgICAgICAgICAgbnVsbCwKICAgICAgaW5pdGlhbFJlYWR5OiB0cnVlCiAgICB9OwogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBzY2hlbWEoKSB7CiAgICAgIGNvbnN0IGluU3RvcmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjdXJyZW50U3RvcmUnXSh0aGlzLnZhbHVlLnR5cGUpOwoKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbYCR7IGluU3RvcmUgfS9zY2hlbWFGb3JgXSggdGhpcy52YWx1ZS50eXBlICk7CiAgICB9LAoKICAgIGlzQ3JlYXRlKCkgewogICAgICByZXR1cm4gdGhpcy5tb2RlID09PSBfQ1JFQVRFOwogICAgfSwKCiAgICBpc1ZpZXcoKSB7CiAgICAgIHJldHVybiB0aGlzLm1vZGUgPT09IF9WSUVXOwogICAgfSwKCiAgICBpc0VkaXQoKSB7CiAgICAgIHJldHVybiB0aGlzLm1vZGUgPT09IF9FRElUOwogICAgfSwKCiAgICBlZGl0b3JNb2RlKCkgewogICAgICAvLyBJbmNsdWRlIHRoZSBtb2RlIGluIHRoZSByb3V0ZSBhcyBhIGRlcGVuZGVuY3kKICAgICAgLy8gb2YgdGhpcyBjb21wdXRlZCBwcm9wZXJ0eSBzbyB0aGF0IHRoZSBlZGl0b3IKICAgICAgLy8gdG9nZ2xlcyB3aGVuIHlvdSBuYXZpZ2F0ZSBiYWNrIGFuZCBmb3J0aCBiZXR3ZWVuCiAgICAgIC8vIGVkaXQgYW5kIHZpZXcuCiAgICAgIGlmICggdGhpcy4kcm91dGUucXVlcnkubW9kZSA9PT0gX1ZJRVcgfHwgKHRoaXMuaXNWaWV3ICYmICh0aGlzLiRyb3V0ZS5xdWVyeS5tb2RlICE9PSBfRURJVCB8fCB0aGlzLiRyb3V0ZS5xdWVyeS5tb2RlICE9PSBfVklFVykpKSB7CiAgICAgICAgcmV0dXJuIEVESVRPUl9NT0RFUy5WSUVXX0NPREU7CiAgICAgIH0gZWxzZSBpZiAoIHRoaXMuc2hvd1ByZXZpZXcgKSB7CiAgICAgICAgcmV0dXJuIEVESVRPUl9NT0RFUy5ESUZGX0NPREU7CiAgICAgIH0KCiAgICAgIHJldHVybiBFRElUT1JfTU9ERVMuRURJVF9DT0RFOwogICAgfSwKCiAgICBjYW5EaWZmKCkgewogICAgICByZXR1cm4gdGhpcy5pbml0aWFsWWFtbCAhPT0gdGhpcy5jdXJyZW50WWFtbDsKICAgIH0sCiAgfSwKCiAgd2F0Y2g6IHsKICAgIHlhbWwobmV1KSB7CiAgICAgIGlmICggdGhpcy5tb2RlID09PSBfVklFVyApIHsKICAgICAgICB0aGlzLmN1cnJlbnRZYW1sID0gbmV1OwogICAgICB9CiAgICB9LAoKICAgIG1vZGUobmV1LCBvbGQpIHsKICAgICAgLy8gaWYgdGhpcyBjb21wb25lbnQgaXMgY2hhbmdpbmcgZnJvbSB2aWV3aW5nIGEgcmVzb3VyY2UgdG8gJ2NyZWF0aW5nJyB0aGF0IHJlc291cmNlLCBpdCBtdXN0IGFjdHVhbGx5IGJlIGNsb25pbmcKICAgICAgLy8gY2xlYW4geWFtbCBhY2NvcmRpbmdseQogICAgICBpZiAobmV1ID09PSBfQ1JFQVRFICYmIG9sZCA9PT0gX1ZJRVcpIHsKICAgICAgICB0aGlzLmN1cnJlbnRZYW1sID0gdGhpcy52YWx1ZS5jbGVhbllhbWwodGhpcy55YW1sLCBuZXUpOwogICAgICB9CiAgICB9CiAgfSwKCiAgbWV0aG9kczogewogICAgb25JbnB1dCh5YW1sKSB7CiAgICAgIHRoaXMuY3VycmVudFlhbWwgPSB5YW1sOwogICAgICB0aGlzLm9uUmVhZHkodGhpcy5jbSk7CiAgICB9LAoKICAgIG9uUmVhZHkoY20pIHsKICAgICAgaWYgKCF0aGlzLmluaXRpYWxSZWFkeSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLmluaXRpYWxSZWFkeSA9IGZhbHNlOwoKICAgICAgdGhpcy5jbSA9IGNtOwoKICAgICAgaWYgKCB0aGlzLmlzRWRpdCApIHsKICAgICAgICBjbS5mb2xkTGluZXNNYXRjaGluZygvXnN0YXR1czpccyokLyk7CiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcGFyc2VkID0ganN5YW1sLmxvYWQodGhpcy5jdXJyZW50WWFtbCk7CiAgICAgICAgY29uc3QgYW5ub3RhdGlvbnMgPSBPYmplY3Qua2V5cyhwYXJzZWQ/Lm1ldGFkYXRhPy5hbm5vdGF0aW9ucyB8fCB7fSk7CiAgICAgICAgY29uc3QgcmVnZXhlcyA9IEFOTk9UQVRJT05TX1RPX0ZPTEQubWFwKCh4KSA9PiBlbnN1cmVSZWdleCh4KSk7CgogICAgICAgIGxldCBmb2xkQW5ub3RhdGlvbnMgPSBmYWxzZTsKCiAgICAgICAgZm9yICggY29uc3QgayBvZiBhbm5vdGF0aW9ucyApIHsKICAgICAgICAgIGlmICggZm9sZEFubm90YXRpb25zICkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKCBjb25zdCByZWdleCBvZiByZWdleGVzICkgewogICAgICAgICAgICBpZiAoIGsubWF0Y2gocmVnZXgpICkgewogICAgICAgICAgICAgIGZvbGRBbm5vdGF0aW9ucyA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICggZm9sZEFubm90YXRpb25zICkgewogICAgICAgICAgY20uZm9sZExpbmVzTWF0Y2hpbmcoL15ccythbm5vdGF0aW9uczpccyokLyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlKSB7fQoKICAgICAgY20uZm9sZExpbmVzTWF0Y2hpbmcoL21hbmFnZWRGaWVsZHMvKTsKCiAgICAgIC8vIEFsbG93IHRoZSBtb2RlbCB0byBzdXBwbHkgYW4gYXJyYXkgb2YganNvbiBwYXRocyB0byBmb2xkIG90aGVyIHNlY3Rpb25zIGluIHRoZSBZQU1MIGZvciB0aGUgZ2l2ZW4gcmVzb3VyY2UgdHlwZQogICAgICBpZiAodGhpcy52YWx1ZT8ueWFtbEZvbGRpbmcpIHsKICAgICAgICB0aGlzLnZhbHVlLnlhbWxGb2xkaW5nLmZvckVhY2goKHBhdGgpID0+IGNtLmZvbGRZYW1sKHBhdGgpKTsKICAgICAgfQoKICAgICAgLy8gcmVnYXJkbGVzcyBvZiBlZGl0IG9yIGNyZWF0ZSB3ZSBzaG91bGQgcHJvYmFibHkgZm9sZCBhbGwgdGhlIGNvbW1lbnRzIHNvIHRoZXkgZG9udCBnZXQgb3V0IG9mIGhhbmQuCiAgICAgIGNvbnN0IHNhdmVkID0gY20uZ2V0TW9kZSgpLmZvbGQ7CgogICAgICBjbS5nZXRNb2RlKCkuZm9sZCA9ICd5YW1sY29tbWVudHMnOwogICAgICBjbS5leGVjQ29tbWFuZCgnZm9sZEFsbCcpOwogICAgICBjbS5nZXRNb2RlKCkuZm9sZCA9IHNhdmVkOwogICAgfSwKCiAgICBvbkNoYW5nZXMoY20sIGNoYW5nZXMpIHsKICAgICAgaWYgKCBjaGFuZ2VzLmxlbmd0aCAhPT0gMSApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGNoYW5nZSA9IGNoYW5nZXNbMF07CgogICAgICBpZiAoIGNoYW5nZS5mcm9tLmxpbmUgIT09IGNoYW5nZS50by5saW5lICkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgbGV0IGxpbmUgPSBjaGFuZ2UuZnJvbS5saW5lOwogICAgICBsZXQgc3RyID0gY20uZ2V0TGluZShsaW5lKTsKICAgICAgbGV0IG1heEluZGVudCA9IGluZGVudENoYXJzKHN0cik7CgogICAgICBpZiAoIG1heEluZGVudCA9PT0gbnVsbCApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNtLnJlcGxhY2VSYW5nZSgnJywgeyBsaW5lLCBjaDogMCB9LCB7IGxpbmUsIGNoOiAxIH0sICcraW5wdXQnKTsKCiAgICAgIHdoaWxlICggbGluZSA+IDAgKSB7CiAgICAgICAgbGluZS0tOwogICAgICAgIHN0ciA9IGNtLmdldExpbmUobGluZSk7CiAgICAgICAgY29uc3QgaW5kZW50ID0gaW5kZW50Q2hhcnMoc3RyKTsKCiAgICAgICAgaWYgKCBpbmRlbnQgPT09IG51bGwgKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGlmICggaW5kZW50IDwgbWF4SW5kZW50ICkgewogICAgICAgICAgY20ucmVwbGFjZVJhbmdlKCcnLCB7IGxpbmUsIGNoOiAwIH0sIHsgbGluZSwgY2g6IDEgfSwgJytpbnB1dCcpOwoKICAgICAgICAgIGlmICggaW5kZW50ID09PSAwICkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBtYXhJbmRlbnQgPSBpbmRlbnQ7CiAgICAgICAgfQogICAgICB9CgogICAgICBmdW5jdGlvbiBpbmRlbnRDaGFycyhzdHIpIHsKICAgICAgICBjb25zdCBtYXRjaCA9IHN0ci5tYXRjaCgvXiMoXHMrKS8pOwoKICAgICAgICBpZiAoIG1hdGNoICkgewogICAgICAgICAgcmV0dXJuIG1hdGNoWzFdLmxlbmd0aDsKICAgICAgICB9CgogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9LAoKICAgIHVwZGF0ZVZhbHVlKHZhbHVlKSB7CiAgICAgIHRoaXMuJHJlZnMueWFtbGVkaXRvci51cGRhdGVWYWx1ZSh2YWx1ZSk7CiAgICB9LAoKICAgIHByZXZpZXcoKSB7CiAgICAgIHRoaXMudXBkYXRlVmFsdWUodGhpcy5jdXJyZW50WWFtbCk7CiAgICAgIHRoaXMuc2hvd1ByZXZpZXcgPSB0cnVlOwogICAgICB0aGlzLiRyb3V0ZXIuYXBwbHlRdWVyeSh7IFtQUkVWSUVXXTogX0ZMQUdHRUQgfSk7CiAgICB9LAoKICAgIHVucHJldmlldygpIHsKICAgICAgdGhpcy5zaG93UHJldmlldyA9IGZhbHNlOwogICAgICB0aGlzLiRyb3V0ZXIuYXBwbHlRdWVyeSh7IFtQUkVWSUVXXTogX1VORkxBRyB9KTsKICAgIH0sCgogICAgYXN5bmMgc2F2ZShidXR0b25Eb25lKSB7CiAgICAgIGNvbnN0IHlhbWwgPSB0aGlzLnZhbHVlLnlhbWxGb3JTYXZlKHRoaXMuY3VycmVudFlhbWwpIHx8IHRoaXMuY3VycmVudFlhbWw7CgogICAgICB0cnkgewogICAgICAgIGlmICggdGhpcy5hcHBseUhvb2tzICkgewogICAgICAgICAgYXdhaXQgdGhpcy5hcHBseUhvb2tzKEJFRk9SRV9TQVZFX0hPT0tTKTsKICAgICAgICB9CgogICAgICAgIHRyeSB7CiAgICAgICAgICBhd2FpdCB0aGlzLnZhbHVlLnNhdmVZYW1sKHlhbWwpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgcmV0dXJuIG9uRXJyb3IuY2FsbCh0aGlzLCBlcnIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCB0aGlzLmFwcGx5SG9va3MgKSB7CiAgICAgICAgICBhd2FpdCB0aGlzLmFwcGx5SG9va3MoQUZURVJfU0FWRV9IT09LUyk7CiAgICAgICAgfQoKICAgICAgICBidXR0b25Eb25lKHRydWUpOwogICAgICAgIHRoaXMuZG9uZSgpOwogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICByZXR1cm4gb25FcnJvci5jYWxsKHRoaXMsIGVycik7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIG9uRXJyb3IoZXJyKSB7CiAgICAgICAgaWYgKCBlcnIgJiYgZXJyLnJlc3BvbnNlICYmIGVyci5yZXNwb25zZS5kYXRhICkgewogICAgICAgICAgY29uc3QgYm9keSA9IGVyci5yZXNwb25zZS5kYXRhOwoKICAgICAgICAgIGlmICggYm9keSAmJiBib2R5Lm1lc3NhZ2UgKSB7CiAgICAgICAgICAgIHRoaXMuZXJyb3JzID0gW2JvZHkubWVzc2FnZV07CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmVycm9ycyA9IFtlcnJdOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmVycm9ycyA9IFtlcnJdOwogICAgICAgIH0KCiAgICAgICAgYnV0dG9uRG9uZShmYWxzZSk7CgogICAgICAgIHRoaXMuJGVtaXQoJ2Vycm9yJywgZXhjZXB0aW9uVG9FcnJvcnNBcnJheShlcnIpKTsKICAgICAgfQogICAgfSwKCiAgICBkb25lKCkgewogICAgICBpZiAodGhpcy5kb25lT3ZlcnJpZGUpIHsKICAgICAgICByZXR1cm4gdHlwZW9mICh0aGlzLmRvbmVPdmVycmlkZSkgPT09ICdmdW5jdGlvbicgPyB0aGlzLmRvbmVPdmVycmlkZSgpIDogdGhpcy4kcm91dGVyLnJlcGxhY2UodGhpcy5kb25lT3ZlcnJpZGUpOwogICAgICB9CiAgICAgIGlmICggIXRoaXMuZG9uZVJvdXRlICkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodHlwZU9mKHRoaXMuZG9uZVJvdXRlKSA9PT0gJ29iamVjdCcpIHsKICAgICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSh0aGlzLmRvbmVSb3V0ZSk7CgogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSh7CiAgICAgICAgbmFtZTogICB0aGlzLmRvbmVSb3V0ZSwKICAgICAgICBwYXJhbXM6IHsgcmVzb3VyY2U6IHRoaXMudmFsdWUudHlwZSB9CiAgICAgIH0pOwogICAgfSwKCiAgICBvbkZpbGVTZWxlY3RlZCh2YWx1ZSkgewogICAgICBjb25zdCBjb21wb25lbnQgPSB0aGlzLiRyZWZzLnlhbWxlZGl0b3I7CgogICAgICBpZiAoY29tcG9uZW50KSB7CiAgICAgICAgY29tcG9uZW50LnVwZGF0ZVZhbHVlKHZhbHVlKTsKICAgICAgfQogICAgfSwKCiAgfQp9Owo="},{"version":3,"sources":["ResourceYaml.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA","file":"ResourceYaml.vue","sourceRoot":"../../node_modules/@rancher/shell/components","sourcesContent":["<script>\nimport jsyaml from 'js-yaml';\nimport YamlEditor, { EDITOR_MODES } from '@shell/components/YamlEditor';\nimport FileSelector from '@shell/components/form/FileSelector';\nimport Footer from '@shell/components/form/Footer';\nimport { ANNOTATIONS_TO_FOLD } from '@shell/config/labels-annotations';\nimport { ensureRegex } from '@shell/utils/string';\nimport { typeOf } from '@shell/utils/sort';\n\nimport {\n  _CREATE,\n  _VIEW,\n  PREVIEW,\n  _FLAGGED,\n  _UNFLAG,\n  _EDIT,\n} from '@shell/config/query-params';\nimport { BEFORE_SAVE_HOOKS, AFTER_SAVE_HOOKS } from '@shell/mixins/child-hook';\nimport { exceptionToErrorsArray } from '@shell/utils/error';\n\nexport default {\n  components: {\n    Footer,\n    FileSelector,\n    YamlEditor\n  },\n\n  props: {\n    mode: {\n      type:     String,\n      required: true,\n    },\n\n    value: {\n      type:     Object,\n      required: true,\n    },\n\n    initialYamlForDiff: {\n      type:    String,\n      default: null,\n    },\n\n    yaml: {\n      type:     String,\n      required: true,\n    },\n\n    doneRoute: {\n      type:    [String, Object],\n      default: null,\n    },\n\n    offerPreview: {\n      type:    Boolean,\n      default: true,\n    },\n\n    parentParams: {\n      type:    Object,\n      default: null,\n    },\n\n    doneOverride: {\n      type:    [Function, Object],\n      default: null\n    },\n\n    showFooter: {\n      type:    Boolean,\n      default: true\n    },\n\n    applyHooks: {\n      type:    Function,\n      default: null,\n    }\n  },\n\n  data() {\n    // Initial load with a preview showing no diff isn't very useful\n    this.$router.applyQuery({ [PREVIEW]: _UNFLAG });\n\n    return {\n      initialYaml:  this.initialYamlForDiff || this.yaml,\n      currentYaml:  this.yaml,\n      showPreview:  false,\n      errors:       null,\n      cm:           null,\n      initialReady: true\n    };\n  },\n\n  computed: {\n    schema() {\n      const inStore = this.$store.getters['currentStore'](this.value.type);\n\n      return this.$store.getters[`${ inStore }/schemaFor`]( this.value.type );\n    },\n\n    isCreate() {\n      return this.mode === _CREATE;\n    },\n\n    isView() {\n      return this.mode === _VIEW;\n    },\n\n    isEdit() {\n      return this.mode === _EDIT;\n    },\n\n    editorMode() {\n      // Include the mode in the route as a dependency\n      // of this computed property so that the editor\n      // toggles when you navigate back and forth between\n      // edit and view.\n      if ( this.$route.query.mode === _VIEW || (this.isView && (this.$route.query.mode !== _EDIT || this.$route.query.mode !== _VIEW))) {\n        return EDITOR_MODES.VIEW_CODE;\n      } else if ( this.showPreview ) {\n        return EDITOR_MODES.DIFF_CODE;\n      }\n\n      return EDITOR_MODES.EDIT_CODE;\n    },\n\n    canDiff() {\n      return this.initialYaml !== this.currentYaml;\n    },\n  },\n\n  watch: {\n    yaml(neu) {\n      if ( this.mode === _VIEW ) {\n        this.currentYaml = neu;\n      }\n    },\n\n    mode(neu, old) {\n      // if this component is changing from viewing a resource to 'creating' that resource, it must actually be cloning\n      // clean yaml accordingly\n      if (neu === _CREATE && old === _VIEW) {\n        this.currentYaml = this.value.cleanYaml(this.yaml, neu);\n      }\n    }\n  },\n\n  methods: {\n    onInput(yaml) {\n      this.currentYaml = yaml;\n      this.onReady(this.cm);\n    },\n\n    onReady(cm) {\n      if (!this.initialReady) {\n        return;\n      }\n      this.initialReady = false;\n\n      this.cm = cm;\n\n      if ( this.isEdit ) {\n        cm.foldLinesMatching(/^status:\\s*$/);\n      }\n\n      try {\n        const parsed = jsyaml.load(this.currentYaml);\n        const annotations = Object.keys(parsed?.metadata?.annotations || {});\n        const regexes = ANNOTATIONS_TO_FOLD.map((x) => ensureRegex(x));\n\n        let foldAnnotations = false;\n\n        for ( const k of annotations ) {\n          if ( foldAnnotations ) {\n            break;\n          }\n\n          for ( const regex of regexes ) {\n            if ( k.match(regex) ) {\n              foldAnnotations = true;\n              break;\n            }\n          }\n        }\n\n        if ( foldAnnotations ) {\n          cm.foldLinesMatching(/^\\s+annotations:\\s*$/);\n        }\n      } catch (e) {}\n\n      cm.foldLinesMatching(/managedFields/);\n\n      // Allow the model to supply an array of json paths to fold other sections in the YAML for the given resource type\n      if (this.value?.yamlFolding) {\n        this.value.yamlFolding.forEach((path) => cm.foldYaml(path));\n      }\n\n      // regardless of edit or create we should probably fold all the comments so they dont get out of hand.\n      const saved = cm.getMode().fold;\n\n      cm.getMode().fold = 'yamlcomments';\n      cm.execCommand('foldAll');\n      cm.getMode().fold = saved;\n    },\n\n    onChanges(cm, changes) {\n      if ( changes.length !== 1 ) {\n        return;\n      }\n\n      const change = changes[0];\n\n      if ( change.from.line !== change.to.line ) {\n        return;\n      }\n\n      let line = change.from.line;\n      let str = cm.getLine(line);\n      let maxIndent = indentChars(str);\n\n      if ( maxIndent === null ) {\n        return;\n      }\n\n      cm.replaceRange('', { line, ch: 0 }, { line, ch: 1 }, '+input');\n\n      while ( line > 0 ) {\n        line--;\n        str = cm.getLine(line);\n        const indent = indentChars(str);\n\n        if ( indent === null ) {\n          break;\n        }\n\n        if ( indent < maxIndent ) {\n          cm.replaceRange('', { line, ch: 0 }, { line, ch: 1 }, '+input');\n\n          if ( indent === 0 ) {\n            break;\n          }\n\n          maxIndent = indent;\n        }\n      }\n\n      function indentChars(str) {\n        const match = str.match(/^#(\\s+)/);\n\n        if ( match ) {\n          return match[1].length;\n        }\n\n        return null;\n      }\n    },\n\n    updateValue(value) {\n      this.$refs.yamleditor.updateValue(value);\n    },\n\n    preview() {\n      this.updateValue(this.currentYaml);\n      this.showPreview = true;\n      this.$router.applyQuery({ [PREVIEW]: _FLAGGED });\n    },\n\n    unpreview() {\n      this.showPreview = false;\n      this.$router.applyQuery({ [PREVIEW]: _UNFLAG });\n    },\n\n    async save(buttonDone) {\n      const yaml = this.value.yamlForSave(this.currentYaml) || this.currentYaml;\n\n      try {\n        if ( this.applyHooks ) {\n          await this.applyHooks(BEFORE_SAVE_HOOKS);\n        }\n\n        try {\n          await this.value.saveYaml(yaml);\n        } catch (err) {\n          return onError.call(this, err);\n        }\n\n        if ( this.applyHooks ) {\n          await this.applyHooks(AFTER_SAVE_HOOKS);\n        }\n\n        buttonDone(true);\n        this.done();\n      } catch (err) {\n        return onError.call(this, err);\n      }\n\n      function onError(err) {\n        if ( err && err.response && err.response.data ) {\n          const body = err.response.data;\n\n          if ( body && body.message ) {\n            this.errors = [body.message];\n          } else {\n            this.errors = [err];\n          }\n        } else {\n          this.errors = [err];\n        }\n\n        buttonDone(false);\n\n        this.$emit('error', exceptionToErrorsArray(err));\n      }\n    },\n\n    done() {\n      if (this.doneOverride) {\n        return typeof (this.doneOverride) === 'function' ? this.doneOverride() : this.$router.replace(this.doneOverride);\n      }\n      if ( !this.doneRoute ) {\n        return;\n      }\n      if (typeOf(this.doneRoute) === 'object') {\n        this.$router.replace(this.doneRoute);\n\n        return;\n      }\n      this.$router.replace({\n        name:   this.doneRoute,\n        params: { resource: this.value.type }\n      });\n    },\n\n    onFileSelected(value) {\n      const component = this.$refs.yamleditor;\n\n      if (component) {\n        component.updateValue(value);\n      }\n    },\n\n  }\n};\n</script>\n\n<template>\n  <div class=\"root resource-yaml\">\n    <YamlEditor\n      ref=\"yamleditor\"\n      v-model=\"currentYaml\"\n      :initial-yaml-values=\"initialYaml\"\n      class=\"yaml-editor flex-content\"\n      :editor-mode=\"editorMode\"\n      @onInput=\"onInput\"\n      @onReady=\"onReady\"\n      @onChanges=\"onChanges\"\n    />\n    <slot\n      name=\"yamlFooter\"\n      :currentYaml=\"currentYaml\"\n      :showPreview=\"showPreview\"\n      :yamlPreview=\"preview\"\n      :yamlSave=\"save\"\n      :yamlUnpreview=\"unpreview\"\n      :canDiff=\"canDiff\"\n    >\n      <Footer\n        v-if=\"showFooter\"\n        class=\"footer\"\n        :class=\"{ 'edit': !isView }\"\n        :mode=\"mode\"\n        :errors=\"errors\"\n        @save=\"save\"\n        @done=\"done\"\n      >\n        <template\n          v-if=\"!isView\"\n          #left\n        >\n          <FileSelector\n            class=\"btn role-secondary\"\n            :label=\"t('generic.readFromFile')\"\n            @selected=\"onFileSelected\"\n          />\n        </template>\n        <template\n          v-if=\"!isView\"\n          #middle\n        >\n          <button\n            v-if=\"showPreview\"\n            type=\"button\"\n            class=\"btn role-secondary\"\n            @click=\"unpreview\"\n          >\n            <t k=\"resourceYaml.buttons.continue\" />\n          </button>\n          <button\n            v-else-if=\"offerPreview\"\n            :disabled=\"!canDiff\"\n            type=\"button\"\n            class=\"btn role-secondary\"\n            @click=\"preview\"\n          >\n            <t k=\"resourceYaml.buttons.diff\" />\n          </button>\n        </template>\n      </Footer>\n    </slot>\n  </div>\n</template>\n\n<style lang='scss' scoped>\n  .flex-content {\n    display: flex;\n    flex-direction: column;\n    flex-grow: 1;\n  }\n\n  .footer {\n    margin-top: 20px;\n    right: 0;\n    position: sticky;\n    bottom: 0;\n    background-color: var(--header-bg);\n\n    // Overrides outlet padding\n    margin-left: -$space-m;\n    margin-right: -$space-m;\n    margin-bottom: -$space-m;\n    padding: $space-s $space-m;\n\n    &.edit {\n      border-top: var(--header-border-size) solid var(--header-border);\n    }\n  }\n</style>\n\n<style lang=\"scss\">\n.resource-yaml {\n  .yaml-editor {\n    min-height: 200px;\n  }\n\n  footer .actions {\n    text-align: right;\n  }\n\n  .spacer-small {\n    padding: 0;\n  }\n}\n\n</style>\n"]}]}
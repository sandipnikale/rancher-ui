{"remainingRequest":"/app/node_modules/thread-loader/dist/cjs.js!/app/node_modules/babel-loader/lib/index.js!/app/node_modules/cache-loader/dist/cjs.js??ref--2-0!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/node_modules/@rancher/shell/components/form/FileSelector.vue?vue&type=script&lang=js","dependencies":[{"path":"/app/node_modules/@rancher/shell/components/form/FileSelector.vue","mtime":1764054237091},{"path":"/app/pkg/rancher-support-ui/babel.config.js","mtime":1764051174054},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1764054259024},{"path":"/app/node_modules/thread-loader/dist/cjs.js","mtime":1764054259111},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":1764054258910},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1764054259024},{"path":"/app/node_modules/vue-loader/lib/index.js","mtime":1764054260995}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgX0VESVQsIF9WSUVXIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwppbXBvcnQgeyBzZXQgfSBmcm9tICdAc2hlbGwvdXRpbHMvb2JqZWN0JzsKZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9uU2VsZWN0ZWQoZmllbGQpIHsKICByZXR1cm4gZnVuY3Rpb24gKGNvbnRlbnRzKSB7CiAgICBzZXQodGhpcywgZmllbGQsIGNvbnRlbnRzKTsKICB9Owp9CmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgbGFiZWw6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfSwKICAgIG1vZGU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiBfRURJVAogICAgfSwKICAgIGRpc2FibGVkOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgaW5jbHVkZUZpbGVOYW1lOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgc2hvd0dyb3dsRXJyb3I6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfSwKICAgIG11bHRpcGxlOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgYnl0ZUxpbWl0OiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogMAogICAgfSwKICAgIHJlYWRBc0RhdGFVcmw6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICBkaXJlY3Rvcnk6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICByYXdEYXRhOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgYWNjZXB0OiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJyonCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgaXNWaWV3KCkgewogICAgICByZXR1cm4gdGhpcy5tb2RlID09PSBfVklFVzsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHNlbGVjdEZpbGUoKSB7CiAgICAgIC8vIENsZWFyIHRoZSB2YWx1ZSBzbyB0aGUgdXNlciBjYW4gcmVzZWxlY3QgdGhlIHNhbWUgZmlsZSBhZ2FpbgogICAgICB0aGlzLiRyZWZzLnVwbG9hZGVyLnZhbHVlID0gbnVsbDsKICAgICAgdGhpcy4kcmVmcy51cGxvYWRlci5jbGljaygpOwogICAgfSwKICAgIGFzeW5jIGZpbGVDaGFuZ2UoZXZlbnQpIHsKICAgICAgY29uc3QgaW5wdXQgPSBldmVudC50YXJnZXQ7CiAgICAgIGNvbnN0IGZpbGVzID0gQXJyYXkuZnJvbShpbnB1dC5maWxlcyB8fCBbXSk7CiAgICAgIGlmICh0aGlzLmJ5dGVMaW1pdCkgewogICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykgewogICAgICAgICAgaWYgKGZpbGUuc2l6ZSA+IHRoaXMuYnl0ZUxpbWl0KSB7CiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2Vycm9yJywgYCR7ZmlsZS5uYW1lfSBleGNlZWRzIHRoZSBmaWxlIHNpemUgbGltaXQgb2YgJHt0aGlzLmJ5dGVMaW1pdH0gYnl0ZXNgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodGhpcy5yYXdEYXRhKSB7CiAgICAgICAgY29uc3QgdW5ib3hlZENvbnRlbnRzID0gIXRoaXMubXVsdGlwbGUgJiYgZmlsZXMubGVuZ3RoID09PSAxID8gZmlsZXNbMF0gOiBmaWxlczsKICAgICAgICB0aGlzLiRlbWl0KCdzZWxlY3RlZCcsIHVuYm94ZWRDb250ZW50cyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgYXN5bmNGaWxlQ29udGVudHMgPSBmaWxlcy5tYXAodGhpcy5nZXRGaWxlQ29udGVudHMpOwogICAgICAgIGNvbnN0IGZpbGVDb250ZW50cyA9IGF3YWl0IFByb21pc2UuYWxsKGFzeW5jRmlsZUNvbnRlbnRzKTsKICAgICAgICBjb25zdCB1bmJveGVkQ29udGVudHMgPSAhdGhpcy5tdWx0aXBsZSAmJiBmaWxlQ29udGVudHMubGVuZ3RoID09PSAxID8gZmlsZUNvbnRlbnRzWzBdIDogZmlsZUNvbnRlbnRzOwogICAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGVkJywgdW5ib3hlZENvbnRlbnRzKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICB0aGlzLiRlbWl0KCdlcnJvcicsIGVycm9yKTsKICAgICAgICBpZiAodGhpcy5zaG93R3Jvd2xFcnJvcikgewogICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2dyb3dsL2Zyb21FcnJvcicsIHsKICAgICAgICAgICAgdGl0bGU6ICdFcnJvciByZWFkaW5nIGZpbGUnLAogICAgICAgICAgICBlcnJvcgogICAgICAgICAgfSwgewogICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBnZXRGaWxlQ29udGVudHMoZmlsZSkgewogICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGV2ID0+IHsKICAgICAgICAgIGNvbnN0IHZhbHVlID0gZXYudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgIGNvbnN0IG5hbWUgPSBmaWxlLm5hbWU7CiAgICAgICAgICBjb25zdCBmaWxlQ29udGVudHMgPSB0aGlzLmluY2x1ZGVGaWxlTmFtZSA/IHsKICAgICAgICAgICAgdmFsdWUsCiAgICAgICAgICAgIG5hbWUKICAgICAgICAgIH0gOiB2YWx1ZTsKICAgICAgICAgIHJlc29sdmUoZmlsZUNvbnRlbnRzKTsKICAgICAgICB9OwogICAgICAgIHJlYWRlci5vbmVycm9yID0gZXJyID0+IHsKICAgICAgICAgIHJlamVjdChlcnIpOwogICAgICAgIH07CiAgICAgICAgaWYgKHRoaXMucmVhZEFzRGF0YVVybCkgewogICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGZpbGUpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["_EDIT","_VIEW","set","createOnSelected","field","contents","props","label","type","String","required","mode","default","disabled","Boolean","includeFileName","showGrowlError","multiple","byteLimit","Number","readAsDataUrl","directory","rawData","accept","computed","isView","methods","selectFile","$refs","uploader","value","click","fileChange","event","input","target","files","Array","from","file","size","$emit","name","unboxedContents","length","asyncFileContents","map","getFileContents","fileContents","Promise","all","error","$store","dispatch","title","root","resolve","reject","reader","FileReader","onload","ev","result","onerror","err","readAsDataURL","readAsText"],"sources":["../../node_modules/@rancher/shell/components/form/FileSelector.vue"],"sourcesContent":["<script>\nimport { _EDIT, _VIEW } from '@shell/config/query-params';\nimport { set } from '@shell/utils/object';\n\nexport function createOnSelected(field) {\n  return function(contents) {\n    set(this, field, contents);\n  };\n}\n\nexport default {\n  props: {\n    label: {\n      type:     String,\n      required: true\n    },\n\n    mode: {\n      type:    String,\n      default: _EDIT\n    },\n\n    disabled: {\n      type:    Boolean,\n      default: false,\n    },\n\n    includeFileName: {\n      type:    Boolean,\n      default: false,\n    },\n\n    showGrowlError: {\n      type:    Boolean,\n      default: true\n    },\n\n    multiple: {\n      type:    Boolean,\n      default: false\n    },\n\n    byteLimit: {\n      type:    Number,\n      default: 0\n    },\n\n    readAsDataUrl: {\n      type:    Boolean,\n      default: false\n    },\n\n    directory: {\n      type:    Boolean,\n      default: false\n    },\n\n    rawData: {\n      type:    Boolean,\n      default: false\n    },\n\n    accept: {\n      type:    String,\n      default: '*'\n    },\n\n  },\n\n  computed: {\n    isView() {\n      return this.mode === _VIEW;\n    }\n  },\n\n  methods: {\n    selectFile() {\n      // Clear the value so the user can reselect the same file again\n      this.$refs.uploader.value = null;\n      this.$refs.uploader.click();\n    },\n\n    async fileChange(event) {\n      const input = event.target;\n      const files = Array.from(input.files || []);\n\n      if (this.byteLimit) {\n        for (const file of files) {\n          if (file.size > this.byteLimit) {\n            this.$emit('error', `${ file.name } exceeds the file size limit of ${ this.byteLimit } bytes`);\n\n            return;\n          }\n        }\n      }\n\n      if (this.rawData) {\n        const unboxedContents = !this.multiple && files.length === 1 ? files[0] : files;\n\n        this.$emit('selected', unboxedContents);\n\n        return;\n      }\n\n      try {\n        const asyncFileContents = files.map(this.getFileContents);\n        const fileContents = await Promise.all(asyncFileContents);\n        const unboxedContents = !this.multiple && fileContents.length === 1 ? fileContents[0] : fileContents;\n\n        this.$emit('selected', unboxedContents);\n      } catch (error) {\n        this.$emit('error', error);\n        if (this.showGrowlError) {\n          this.$store.dispatch('growl/fromError', { title: 'Error reading file', error }, { root: true });\n        }\n      }\n    },\n\n    getFileContents(file) {\n      return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n\n        reader.onload = (ev) => {\n          const value = ev.target.result;\n          const name = file.name;\n          const fileContents = this.includeFileName ? { value, name } : value;\n\n          resolve(fileContents);\n        };\n\n        reader.onerror = (err) => {\n          reject(err);\n        };\n        if (this.readAsDataUrl) {\n          reader.readAsDataURL(file);\n        } else {\n          reader.readAsText(file);\n        }\n      });\n    }\n  }\n};\n</script>\n\n<template>\n  <button\n    v-if=\"!isView\"\n    :disabled=\"disabled\"\n    type=\"button\"\n    class=\"file-selector btn\"\n    data-testid=\"file-selector__uploader-button\"\n    @click=\"selectFile\"\n  >\n    <span>{{ label }}</span>\n    <input\n      ref=\"uploader\"\n      type=\"file\"\n      class=\"hide\"\n      :multiple=\"multiple\"\n      :webkitdirectory=\"directory\"\n      :accept=\"accept\"\n      @change=\"fileChange\"\n    >\n  </button>\n</template>\n"],"mappings":"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","ignoreList":[]}]}
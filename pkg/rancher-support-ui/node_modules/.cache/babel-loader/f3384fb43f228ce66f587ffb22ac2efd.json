{"remainingRequest":"/app/node_modules/thread-loader/dist/cjs.js!/app/node_modules/babel-loader/lib/index.js!/app/node_modules/@rancher/shell/utils/validators/role-template.js","dependencies":[{"path":"/app/node_modules/@rancher/shell/utils/validators/role-template.js","mtime":1764054237091},{"path":"/app/pkg/rancher-support-ui/babel.config.js","mtime":1764051174054},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1764054259024},{"path":"/app/node_modules/thread-loader/dist/cjs.js","mtime":1764054259111},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":1764054258910}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgUkJBQyB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgaXNFbXB0eSBmcm9tICdsb2Rhc2gvaXNFbXB0eSc7CmV4cG9ydCBmdW5jdGlvbiByb2xlVGVtcGxhdGVSdWxlcyhydWxlcyA9IFtdLCBnZXR0ZXJzLCBlcnJvcnMsIHZhbGlkYXRvckFyZ3MgPSBbXSkgewogIGlmIChydWxlcy5zb21lKHJ1bGUgPT4gaXNFbXB0eShydWxlLnZlcmJzKSkpIHsKICAgIGVycm9ycy5wdXNoKGdldHRlcnNbJ2kxOG4vdCddKCd2YWxpZGF0aW9uLnJvbGVUZW1wbGF0ZS5yb2xlVGVtcGxhdGVSdWxlcy5taXNzaW5nVmVyYicpKTsKICB9CiAgaWYgKHJ1bGVzLnNvbWUocnVsZSA9PiB7CiAgICB2YXIgX3J1bGUkcmVzb3VyY2VzLCBfcnVsZSRub25SZXNvdXJjZVVSTHM7CiAgICByZXR1cm4gKChfcnVsZSRyZXNvdXJjZXMgPSBydWxlLnJlc291cmNlcykgPT09IG51bGwgfHwgX3J1bGUkcmVzb3VyY2VzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcnVsZSRyZXNvdXJjZXMubGVuZ3RoKSAmJiAoKF9ydWxlJG5vblJlc291cmNlVVJMcyA9IHJ1bGUubm9uUmVzb3VyY2VVUkxzKSA9PT0gbnVsbCB8fCBfcnVsZSRub25SZXNvdXJjZVVSTHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ydWxlJG5vblJlc291cmNlVVJMcy5sZW5ndGgpOwogIH0pKSB7CiAgICBlcnJvcnMucHVzaChnZXR0ZXJzWydpMThuL3QnXSgndmFsaWRhdGlvbi5yb2xlVGVtcGxhdGUucm9sZVRlbXBsYXRlUnVsZXMubm9SZXNvdXJjZUFuZE5vblJlc291cmNlJykpOwogIH0KICBpZiAodmFsaWRhdG9yQXJnc1swXSA9PT0gUkJBQy5ST0xFKSB7CiAgICBpZiAocnVsZXMuc29tZShydWxlID0+IGlzRW1wdHkocnVsZS5yZXNvdXJjZXMpKSkgewogICAgICBlcnJvcnMucHVzaChnZXR0ZXJzWydpMThuL3QnXSgndmFsaWRhdGlvbi5yb2xlVGVtcGxhdGUucm9sZVRlbXBsYXRlUnVsZXMubWlzc2luZ1Jlc291cmNlJykpOwogICAgfQogICAgaWYgKHJ1bGVzLnNvbWUocnVsZSA9PiBpc0VtcHR5KHJ1bGUuYXBpR3JvdXBzKSkpIHsKICAgICAgZXJyb3JzLnB1c2goZ2V0dGVyc1snaTE4bi90J10oJ3ZhbGlkYXRpb24ucm9sZVRlbXBsYXRlLnJvbGVUZW1wbGF0ZVJ1bGVzLm1pc3NpbmdBcGlHcm91cCcpKTsKICAgIH0KICB9IGVsc2UgaWYgKHJ1bGVzLnNvbWUocnVsZSA9PiB7CiAgICB2YXIgX3J1bGUkcmVzb3VyY2VzMiwgX3J1bGUkbm9uUmVzb3VyY2VVcmxzOwogICAgcmV0dXJuICgoX3J1bGUkcmVzb3VyY2VzMiA9IHJ1bGUucmVzb3VyY2VzKSA9PT0gbnVsbCB8fCBfcnVsZSRyZXNvdXJjZXMyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcnVsZSRyZXNvdXJjZXMyLmxlbmd0aCkgJiYgKChfcnVsZSRub25SZXNvdXJjZVVybHMgPSBydWxlLm5vblJlc291cmNlVXJscykgPT09IG51bGwgfHwgX3J1bGUkbm9uUmVzb3VyY2VVcmxzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcnVsZSRub25SZXNvdXJjZVVybHMubGVuZ3RoKTsKICB9KSkgewogICAgZXJyb3JzLnB1c2goZ2V0dGVyc1snaTE4bi90J10oJ3ZhbGlkYXRpb24ucm9sZVRlbXBsYXRlLnJvbGVUZW1wbGF0ZVJ1bGVzLm5vUmVzb3VyY2VBbmROb25SZXNvdXJjZScpKTsKICB9CiAgaWYgKHJ1bGVzLnNvbWUocnVsZSA9PiBpc0VtcHR5KHJ1bGUucmVzb3VyY2VzKSAmJiBpc0VtcHR5KHJ1bGUubm9uUmVzb3VyY2VVUkxzKSkpIHsKICAgIGVycm9ycy5wdXNoKGdldHRlcnNbJ2kxOG4vdCddKCd2YWxpZGF0aW9uLnJvbGVUZW1wbGF0ZS5yb2xlVGVtcGxhdGVSdWxlcy5taXNzaW5nT25lUmVzb3VyY2UnKSk7CiAgfQp9"},{"version":3,"names":["RBAC","isEmpty","roleTemplateRules","rules","getters","errors","validatorArgs","some","rule","verbs","push","_rule$resources","_rule$nonResourceURLs","resources","length","nonResourceURLs","ROLE","apiGroups","_rule$resources2","_rule$nonResourceUrls","nonResourceUrls"],"sources":["/app/node_modules/@rancher/shell/utils/validators/role-template.js"],"sourcesContent":["import { RBAC } from '@shell/config/types';\r\nimport isEmpty from 'lodash/isEmpty';\r\n\r\nexport function roleTemplateRules(rules = [], getters, errors, validatorArgs = []) {\r\n  if (rules.some((rule) => isEmpty(rule.verbs))) {\r\n    errors.push(getters['i18n/t']('validation.roleTemplate.roleTemplateRules.missingVerb'));\r\n  }\r\n\r\n  if (rules.some((rule) => rule.resources?.length && rule.nonResourceURLs?.length)) {\r\n    errors.push(getters['i18n/t']('validation.roleTemplate.roleTemplateRules.noResourceAndNonResource'));\r\n  }\r\n\r\n  if (validatorArgs[0] === RBAC.ROLE) {\r\n    if (rules.some((rule) => isEmpty(rule.resources))) {\r\n      errors.push(getters['i18n/t']('validation.roleTemplate.roleTemplateRules.missingResource'));\r\n    }\r\n    if (rules.some((rule) => isEmpty(rule.apiGroups))) {\r\n      errors.push(getters['i18n/t']('validation.roleTemplate.roleTemplateRules.missingApiGroup'));\r\n    }\r\n  } else if (rules.some((rule) => rule.resources?.length && rule.nonResourceUrls?.length)) {\r\n    errors.push(getters['i18n/t']('validation.roleTemplate.roleTemplateRules.noResourceAndNonResource'));\r\n  }\r\n\r\n  if (rules.some((rule) => isEmpty(rule.resources) && isEmpty(rule.nonResourceURLs))) {\r\n    errors.push(getters['i18n/t']('validation.roleTemplate.roleTemplateRules.missingOneResource'));\r\n  }\r\n}\r\n"],"mappings":"AAAA,SAASA,IAAI,QAAQ,qBAAqB;AAC1C,OAAOC,OAAO,MAAM,gBAAgB;AAEpC,OAAO,SAASC,iBAAiBA,CAACC,KAAK,GAAG,EAAE,EAAEC,OAAO,EAAEC,MAAM,EAAEC,aAAa,GAAG,EAAE,EAAE;EACjF,IAAIH,KAAK,CAACI,IAAI,CAAEC,IAAI,IAAKP,OAAO,CAACO,IAAI,CAACC,KAAK,CAAC,CAAC,EAAE;IAC7CJ,MAAM,CAACK,IAAI,CAACN,OAAO,CAAC,QAAQ,CAAC,CAAC,uDAAuD,CAAC,CAAC;EACzF;EAEA,IAAID,KAAK,CAACI,IAAI,CAAEC,IAAI;IAAA,IAAAG,eAAA,EAAAC,qBAAA;IAAA,OAAK,EAAAD,eAAA,GAAAH,IAAI,CAACK,SAAS,cAAAF,eAAA,uBAAdA,eAAA,CAAgBG,MAAM,OAAAF,qBAAA,GAAIJ,IAAI,CAACO,eAAe,cAAAH,qBAAA,uBAApBA,qBAAA,CAAsBE,MAAM;EAAA,EAAC,EAAE;IAChFT,MAAM,CAACK,IAAI,CAACN,OAAO,CAAC,QAAQ,CAAC,CAAC,oEAAoE,CAAC,CAAC;EACtG;EAEA,IAAIE,aAAa,CAAC,CAAC,CAAC,KAAKN,IAAI,CAACgB,IAAI,EAAE;IAClC,IAAIb,KAAK,CAACI,IAAI,CAAEC,IAAI,IAAKP,OAAO,CAACO,IAAI,CAACK,SAAS,CAAC,CAAC,EAAE;MACjDR,MAAM,CAACK,IAAI,CAACN,OAAO,CAAC,QAAQ,CAAC,CAAC,2DAA2D,CAAC,CAAC;IAC7F;IACA,IAAID,KAAK,CAACI,IAAI,CAAEC,IAAI,IAAKP,OAAO,CAACO,IAAI,CAACS,SAAS,CAAC,CAAC,EAAE;MACjDZ,MAAM,CAACK,IAAI,CAACN,OAAO,CAAC,QAAQ,CAAC,CAAC,2DAA2D,CAAC,CAAC;IAC7F;EACF,CAAC,MAAM,IAAID,KAAK,CAACI,IAAI,CAAEC,IAAI;IAAA,IAAAU,gBAAA,EAAAC,qBAAA;IAAA,OAAK,EAAAD,gBAAA,GAAAV,IAAI,CAACK,SAAS,cAAAK,gBAAA,uBAAdA,gBAAA,CAAgBJ,MAAM,OAAAK,qBAAA,GAAIX,IAAI,CAACY,eAAe,cAAAD,qBAAA,uBAApBA,qBAAA,CAAsBL,MAAM;EAAA,EAAC,EAAE;IACvFT,MAAM,CAACK,IAAI,CAACN,OAAO,CAAC,QAAQ,CAAC,CAAC,oEAAoE,CAAC,CAAC;EACtG;EAEA,IAAID,KAAK,CAACI,IAAI,CAAEC,IAAI,IAAKP,OAAO,CAACO,IAAI,CAACK,SAAS,CAAC,IAAIZ,OAAO,CAACO,IAAI,CAACO,eAAe,CAAC,CAAC,EAAE;IAClFV,MAAM,CAACK,IAAI,CAACN,OAAO,CAAC,QAAQ,CAAC,CAAC,8DAA8D,CAAC,CAAC;EAChG;AACF","ignoreList":[]}]}
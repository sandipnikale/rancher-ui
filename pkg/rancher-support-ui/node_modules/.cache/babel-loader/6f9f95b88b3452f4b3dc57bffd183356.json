{"remainingRequest":"/app/node_modules/thread-loader/dist/cjs.js!/app/node_modules/babel-loader/lib/index.js!/app/node_modules/@rancher/shell/plugins/dashboard-store/normalize.js","dependencies":[{"path":"/app/node_modules/@rancher/shell/plugins/dashboard-store/normalize.js","mtime":1764054237091},{"path":"/app/pkg/rancher-support-ui/babel.config.js","mtime":1764051174054},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1764054259024},{"path":"/app/node_modules/thread-loader/dist/cjs.js","mtime":1764054259111},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":1764054258910}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgU0NIRU1BIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCB7IGFwcGx5Q2hhbmdlc2V0LCBjaGFuZ2VzZXQsIGNoYW5nZXNldENvbmZsaWN0cyB9IGZyb20gJ0BzaGVsbC91dGlscy9vYmplY3QnOwpleHBvcnQgY29uc3QgS0VZX0ZJRUxEX0ZPUiA9IHsKICBbU0NIRU1BXTogJ19pZCcsCiAgZGVmYXVsdDogJ2lkJwp9OwpleHBvcnQgZnVuY3Rpb24ga2V5RmllbGRGb3IodHlwZSkgewogIHJldHVybiBLRVlfRklFTERfRk9SW3R5cGVdIHx8IEtFWV9GSUVMRF9GT1JbJ2RlZmF1bHQnXTsKfQpleHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplVHlwZSh0eXBlKSB7CiAgdmFyIF90eXBlOwogIHR5cGUgPSAoKChfdHlwZSA9IHR5cGUpID09PSBudWxsIHx8IF90eXBlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdHlwZS50eXBlKSB8fCB0eXBlIHx8ICcnKS50b0xvd2VyQ2FzZSgpOwogIHJldHVybiB0eXBlOwp9CgovLyBEZXRlY3QgYW5kIHJlc29sdmUgY29uZmxpY3RzIGZyb20gYSA0MDkgcmVzcG9uc2UuCi8vIElmIHRoZXkgYXJlIHJlc29sdmVkLCByZXR1cm4gYSBmYWxzZS15IHZhbHVlCi8vIEVsc2UgdGhleSBjYW4ndCBiZSByZXNvbHZlZCwgcmV0dXJuIGFuIGFycmF5IG9mIGVycm9ycyB0byBzaG93IHRvIHRoZSB1c2VyLgpleHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlQ29uZmxpY3QoaW5pdGlhbFZhbHVlSlNPTiwgdmFsdWUsIGxpdmVWYWx1ZSwgcm9vdEdldHRlcnMsIHN0b3JlLCBzdG9yZU5hbWVzcGFjZSkgewogIGNvbnN0IG9yaWcgPSBhd2FpdCBzdG9yZS5kaXNwYXRjaChgJHtzdG9yZU5hbWVzcGFjZX0vY2xlYW5Gb3JEaWZmYCwgaW5pdGlhbFZhbHVlSlNPTiwgewogICAgcm9vdDogdHJ1ZQogIH0pOwogIGNvbnN0IHVzZXIgPSBhd2FpdCBzdG9yZS5kaXNwYXRjaChgJHtzdG9yZU5hbWVzcGFjZX0vY2xlYW5Gb3JEaWZmYCwgdmFsdWUudG9KU09OKCksIHsKICAgIHJvb3Q6IHRydWUKICB9KTsKICBjb25zdCBjdXIgPSBhd2FpdCBzdG9yZS5kaXNwYXRjaChgJHtzdG9yZU5hbWVzcGFjZX0vY2xlYW5Gb3JEaWZmYCwgbGl2ZVZhbHVlLnRvSlNPTigpLCB7CiAgICByb290OiB0cnVlCiAgfSk7CiAgY29uc3QgYmdDaGFuZ2UgPSBjaGFuZ2VzZXQob3JpZywgY3VyKTsKICBjb25zdCB1c2VyQ2hhbmdlID0gY2hhbmdlc2V0KG9yaWcsIHVzZXIpOwogIGNvbnN0IGFjdHVhbENvbmZsaWN0cyA9IGNoYW5nZXNldENvbmZsaWN0cyhiZ0NoYW5nZSwgdXNlckNoYW5nZSk7CiAgY29uc29sZS5sb2coJ0JhY2tncm91bmQgQ2hhbmdlJywgYmdDaGFuZ2UpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGUKICBjb25zb2xlLmxvZygnVXNlciBDaGFuZ2UnLCB1c2VyQ2hhbmdlKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlCiAgY29uc29sZS5sb2coJ0NvbmZsaWN0cycsIGFjdHVhbENvbmZsaWN0cyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZQoKICB2YWx1ZS5tZXRhZGF0YS5yZXNvdXJjZVZlcnNpb24gPSBsaXZlVmFsdWUubWV0YWRhdGEucmVzb3VyY2VWZXJzaW9uOwogIGFwcGx5Q2hhbmdlc2V0KHZhbHVlLCBiZ0NoYW5nZSk7CiAgaWYgKGFjdHVhbENvbmZsaWN0cy5sZW5ndGgpIHsKICAgIC8vIFN0b3AgdGhlIHNhdmUgYW5kIGxldCB0aGUgdXNlciBpbnNwZWN0IGFuZCBjb250aW51ZSBlZGl0aW5nCiAgICBjb25zdCBvdXQgPSBbcm9vdEdldHRlcnNbJ2kxOG4vdCddKCd2YWxpZGF0aW9uLmNvbmZsaWN0JywgewogICAgICBmaWVsZHM6IGFjdHVhbENvbmZsaWN0cy5qb2luKCcsICcpLAogICAgICBmaWVsZENvdW50OiBhY3R1YWxDb25mbGljdHMubGVuZ3RoCiAgICB9KV07CiAgICByZXR1cm4gb3V0OwogIH0gZWxzZSB7CiAgICAvLyBUaGUgc2F2ZSBjYW4gY29udGludWUKICAgIHJldHVybiBmYWxzZTsKICB9Cn0="},{"version":3,"names":["SCHEMA","applyChangeset","changeset","changesetConflicts","KEY_FIELD_FOR","default","keyFieldFor","type","normalizeType","_type","toLowerCase","handleConflict","initialValueJSON","value","liveValue","rootGetters","store","storeNamespace","orig","dispatch","root","user","toJSON","cur","bgChange","userChange","actualConflicts","console","log","metadata","resourceVersion","length","out","fields","join","fieldCount"],"sources":["/app/node_modules/@rancher/shell/plugins/dashboard-store/normalize.js"],"sourcesContent":["import { SCHEMA } from '@shell/config/types';\n\nimport { applyChangeset, changeset, changesetConflicts } from '@shell/utils/object';\n\nexport const KEY_FIELD_FOR = {\n  [SCHEMA]: '_id',\n  default:  'id',\n};\n\nexport function keyFieldFor(type) {\n  return KEY_FIELD_FOR[type] || KEY_FIELD_FOR['default'];\n}\n\nexport function normalizeType(type) {\n  type = (type?.type || type || '').toLowerCase();\n\n  return type;\n}\n\n// Detect and resolve conflicts from a 409 response.\n// If they are resolved, return a false-y value\n// Else they can't be resolved, return an array of errors to show to the user.\nexport async function handleConflict(initialValueJSON, value, liveValue, rootGetters, store, storeNamespace) {\n  const orig = await store.dispatch(`${ storeNamespace }/cleanForDiff`, initialValueJSON, { root: true });\n  const user = await store.dispatch(`${ storeNamespace }/cleanForDiff`, value.toJSON(), { root: true });\n  const cur = await store.dispatch(`${ storeNamespace }/cleanForDiff`, liveValue.toJSON(), { root: true });\n\n  const bgChange = changeset(orig, cur);\n  const userChange = changeset(orig, user);\n  const actualConflicts = changesetConflicts(bgChange, userChange);\n\n  console.log('Background Change', bgChange); // eslint-disable-line no-console\n  console.log('User Change', userChange); // eslint-disable-line no-console\n  console.log('Conflicts', actualConflicts); // eslint-disable-line no-console\n\n  value.metadata.resourceVersion = liveValue.metadata.resourceVersion;\n  applyChangeset(value, bgChange);\n\n  if ( actualConflicts.length ) {\n    // Stop the save and let the user inspect and continue editing\n    const out = [rootGetters['i18n/t']('validation.conflict', { fields: actualConflicts.join(', '), fieldCount: actualConflicts.length })];\n\n    return out;\n  } else {\n    // The save can continue\n    return false;\n  }\n}\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,qBAAqB;AAE5C,SAASC,cAAc,EAAEC,SAAS,EAAEC,kBAAkB,QAAQ,qBAAqB;AAEnF,OAAO,MAAMC,aAAa,GAAG;EAC3B,CAACJ,MAAM,GAAG,KAAK;EACfK,OAAO,EAAG;AACZ,CAAC;AAED,OAAO,SAASC,WAAWA,CAACC,IAAI,EAAE;EAChC,OAAOH,aAAa,CAACG,IAAI,CAAC,IAAIH,aAAa,CAAC,SAAS,CAAC;AACxD;AAEA,OAAO,SAASI,aAAaA,CAACD,IAAI,EAAE;EAAA,IAAAE,KAAA;EAClCF,IAAI,GAAG,CAAC,EAAAE,KAAA,GAAAF,IAAI,cAAAE,KAAA,uBAAJA,KAAA,CAAMF,IAAI,KAAIA,IAAI,IAAI,EAAE,EAAEG,WAAW,CAAC,CAAC;EAE/C,OAAOH,IAAI;AACb;;AAEA;AACA;AACA;AACA,OAAO,eAAeI,cAAcA,CAACC,gBAAgB,EAAEC,KAAK,EAAEC,SAAS,EAAEC,WAAW,EAAEC,KAAK,EAAEC,cAAc,EAAE;EAC3G,MAAMC,IAAI,GAAG,MAAMF,KAAK,CAACG,QAAQ,CAAC,GAAIF,cAAc,eAAgB,EAAEL,gBAAgB,EAAE;IAAEQ,IAAI,EAAE;EAAK,CAAC,CAAC;EACvG,MAAMC,IAAI,GAAG,MAAML,KAAK,CAACG,QAAQ,CAAC,GAAIF,cAAc,eAAgB,EAAEJ,KAAK,CAACS,MAAM,CAAC,CAAC,EAAE;IAAEF,IAAI,EAAE;EAAK,CAAC,CAAC;EACrG,MAAMG,GAAG,GAAG,MAAMP,KAAK,CAACG,QAAQ,CAAC,GAAIF,cAAc,eAAgB,EAAEH,SAAS,CAACQ,MAAM,CAAC,CAAC,EAAE;IAAEF,IAAI,EAAE;EAAK,CAAC,CAAC;EAExG,MAAMI,QAAQ,GAAGtB,SAAS,CAACgB,IAAI,EAAEK,GAAG,CAAC;EACrC,MAAME,UAAU,GAAGvB,SAAS,CAACgB,IAAI,EAAEG,IAAI,CAAC;EACxC,MAAMK,eAAe,GAAGvB,kBAAkB,CAACqB,QAAQ,EAAEC,UAAU,CAAC;EAEhEE,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEJ,QAAQ,CAAC,CAAC,CAAC;EAC5CG,OAAO,CAACC,GAAG,CAAC,aAAa,EAAEH,UAAU,CAAC,CAAC,CAAC;EACxCE,OAAO,CAACC,GAAG,CAAC,WAAW,EAAEF,eAAe,CAAC,CAAC,CAAC;;EAE3Cb,KAAK,CAACgB,QAAQ,CAACC,eAAe,GAAGhB,SAAS,CAACe,QAAQ,CAACC,eAAe;EACnE7B,cAAc,CAACY,KAAK,EAAEW,QAAQ,CAAC;EAE/B,IAAKE,eAAe,CAACK,MAAM,EAAG;IAC5B;IACA,MAAMC,GAAG,GAAG,CAACjB,WAAW,CAAC,QAAQ,CAAC,CAAC,qBAAqB,EAAE;MAAEkB,MAAM,EAAEP,eAAe,CAACQ,IAAI,CAAC,IAAI,CAAC;MAAEC,UAAU,EAAET,eAAe,CAACK;IAAO,CAAC,CAAC,CAAC;IAEtI,OAAOC,GAAG;EACZ,CAAC,MAAM;IACL;IACA,OAAO,KAAK;EACd;AACF","ignoreList":[]}]}
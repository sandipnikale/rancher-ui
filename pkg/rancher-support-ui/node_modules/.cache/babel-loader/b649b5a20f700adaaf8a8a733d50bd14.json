{"remainingRequest":"/app/node_modules/thread-loader/dist/cjs.js!/app/node_modules/babel-loader/lib/index.js!/app/node_modules/cache-loader/dist/cjs.js??ref--2-0!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/pkg/rancher-support-ui/detail/ranchersupportbundle.rancher.cattle.io.ranchersupportbundle.vue?vue&type=script&lang=js","dependencies":[{"path":"/app/pkg/rancher-support-ui/detail/ranchersupportbundle.rancher.cattle.io.ranchersupportbundle.vue","mtime":1764056447687},{"path":"/app/pkg/rancher-support-ui/babel.config.js","mtime":1764051174054},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1764054259024},{"path":"/app/node_modules/thread-loader/dist/cjs.js","mtime":1764054259111},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":1764054258910},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1764054259024},{"path":"/app/node_modules/vue-loader/lib/index.js","mtime":1764054260995}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFJlc291cmNlVGFicyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL1Jlc291cmNlVGFicyc7CmltcG9ydCBUYWIgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvVGFiYmVkL1RhYic7CmltcG9ydCBTb3J0YWJsZVRhYmxlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1NvcnRhYmxlVGFibGUnOwppbXBvcnQgQmFubmVyIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0Jhbm5lcic7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRGV0YWlsUmFuY2hlclN1cHBvcnRCdW5kbGUnLAogIGNvbXBvbmVudHM6IHsKICAgIFJlc291cmNlVGFicywKICAgIFRhYiwKICAgIFNvcnRhYmxlVGFibGUsCiAgICBCYW5uZXIKICB9LAogIHByb3BzOiB7CiAgICB2YWx1ZTogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgY2x1c3RlcnNIZWFkZXJzKCkgewogICAgICByZXR1cm4gW3sKICAgICAgICBuYW1lOiAnY2x1c3RlcicsCiAgICAgICAgbGFiZWxLZXk6ICd0YWJsZUhlYWRlcnMuY2x1c3RlcicsCiAgICAgICAgdmFsdWU6ICdjbHVzdGVyJwogICAgICB9XTsKICAgIH0sCiAgICBjbHVzdGVyc1Jvd3MoKSB7CiAgICAgIHJldHVybiAodGhpcy52YWx1ZS5zcGVjLmNsdXN0ZXJzIHx8IFtdKS5tYXAoY2x1c3RlciA9PiAoewogICAgICAgIGNsdXN0ZXIKICAgICAgfSkpOwogICAgfSwKICAgIGNhbkRvd25sb2FkKCkgewogICAgICB2YXIgX3RoaXMkdmFsdWUkc3RhdHVzOwogICAgICByZXR1cm4gKChfdGhpcyR2YWx1ZSRzdGF0dXMgPSB0aGlzLnZhbHVlLnN0YXR1cykgPT09IG51bGwgfHwgX3RoaXMkdmFsdWUkc3RhdHVzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyR2YWx1ZSRzdGF0dXMuc3RhdGUpID09PSAnQ29tcGxldGVkJzsKICAgIH0sCiAgICBkb3dubG9hZFVybCgpIHsKICAgICAgdmFyIF90aGlzJCRzdG9yZSRnZXR0ZXJzJDsKICAgICAgLy8gQ29uc3RydWN0IHRoZSBkb3dubG9hZCBVUkwgdXNpbmcgS3ViZXJuZXRlcyBBUEkgcHJveHkKICAgICAgLy8gRm9ybWF0OiAvazhzL2NsdXN0ZXJzLzxjbHVzdGVyLWlkPi9hcGkvdjEvbmFtZXNwYWNlcy88bmFtZXNwYWNlPi9zZXJ2aWNlcy88c2VydmljZS1uYW1lPjo8cG9ydD4vcHJveHkvYnVuZGxlLnppcAogICAgICBjb25zdCBuYW1lc3BhY2UgPSB0aGlzLnZhbHVlLm1ldGFkYXRhLm5hbWVzcGFjZSB8fCAnZGVmYXVsdCc7CiAgICAgIGNvbnN0IHNlcnZpY2VOYW1lID0gYCR7dGhpcy52YWx1ZS5tZXRhZGF0YS5uYW1lfS1jb2xsZWN0b3JgOwogICAgICBjb25zdCBjbHVzdGVySWQgPSAoKF90aGlzJCRzdG9yZSRnZXR0ZXJzJCA9IHRoaXMuJHN0b3JlLmdldHRlcnNbJ2N1cnJlbnRDbHVzdGVyJ10pID09PSBudWxsIHx8IF90aGlzJCRzdG9yZSRnZXR0ZXJzJCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkJHN0b3JlJGdldHRlcnMkLmlkKSB8fCAnbG9jYWwnOwogICAgICByZXR1cm4gYC9rOHMvY2x1c3RlcnMvJHtjbHVzdGVySWR9L2FwaS92MS9uYW1lc3BhY2VzLyR7bmFtZXNwYWNlfS9zZXJ2aWNlcy8ke3NlcnZpY2VOYW1lfTo4MDgwL3Byb3h5L2J1bmRsZS56aXBgOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgZG93bmxvYWRCdW5kbGUoKSB7CiAgICAgIGlmICh0aGlzLmNhbkRvd25sb2FkKSB7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB0aGlzLmRvd25sb2FkVXJsOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["ResourceTabs","Tab","SortableTable","Banner","name","components","props","value","type","Object","required","computed","clustersHeaders","labelKey","clustersRows","spec","clusters","map","cluster","canDownload","_this$value$status","status","state","downloadUrl","_this$$store$getters$","namespace","metadata","serviceName","clusterId","$store","getters","id","methods","downloadBundle","window","location","href"],"sources":["detail/ranchersupportbundle.rancher.cattle.io.ranchersupportbundle.vue"],"sourcesContent":["<script>\nimport ResourceTabs from '@shell/components/form/ResourceTabs';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport SortableTable from '@shell/components/SortableTable';\nimport Banner from '@shell/components/Banner';\n\nexport default {\n  name: 'DetailRancherSupportBundle',\n  components: {\n    ResourceTabs,\n    Tab,\n    SortableTable,\n    Banner,\n  },\n  props: {\n    value: {\n      type: Object,\n      required: true,\n    },\n  },\n  computed: {\n    clustersHeaders() {\n      return [\n        {\n          name: 'cluster',\n          labelKey: 'tableHeaders.cluster',\n          value: 'cluster',\n        },\n      ];\n    },\n    clustersRows() {\n      return (this.value.spec.clusters || []).map(cluster => ({ cluster }));\n    },\n    canDownload() {\n      return this.value.status?.state === 'Completed';\n    },\n    downloadUrl() {\n      // Construct the download URL using Kubernetes API proxy\n      // Format: /k8s/clusters/<cluster-id>/api/v1/namespaces/<namespace>/services/<service-name>:<port>/proxy/bundle.zip\n      const namespace = this.value.metadata.namespace || 'default';\n      const serviceName = `${this.value.metadata.name}-collector`;\n      const clusterId = this.$store.getters['currentCluster']?.id || 'local';\n      \n      return `/k8s/clusters/${clusterId}/api/v1/namespaces/${namespace}/services/${serviceName}:8080/proxy/bundle.zip`;\n    },\n  },\n  methods: {\n    downloadBundle() {\n      if (this.canDownload) {\n        window.location.href = this.downloadUrl;\n      }\n    },\n  },\n};\n</script>\n\n<template>\n  <div>\n    <h2>{{ value.metadata.name }}</h2>\n    \n    <div class=\"row mb-20\">\n      <div class=\"col span-12\">\n        <Banner\n          v-if=\"value.status?.message\"\n          :color=\"value.status.state === 'Failed' ? 'error' : 'info'\"\n        >\n          {{ value.status.message }}\n        </Banner>\n      </div>\n    </div>\n\n    <div class=\"row mb-20\">\n      <div class=\"col span-6\">\n        <div class=\"labeled-input\">\n          <label>{{ t('rancherSupportBundle.state.label') }}</label>\n          <div>{{ value.status?.state || 'Pending' }}</div>\n        </div>\n      </div>\n      <div class=\"col span-6\">\n        <div class=\"labeled-input\">\n          <label>{{ t('rancherSupportBundle.storageClassName.label') }}</label>\n          <div>{{ value.spec?.storageClassName || 'N/A' }}</div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"row mb-20\">\n      <div class=\"col span-12\">\n        <button\n          :disabled=\"!canDownload\"\n          class=\"btn role-primary\"\n          @click=\"downloadBundle\"\n        >\n          {{ t('rancherSupportBundle.download.label') }}\n        </button>\n        <span v-if=\"!canDownload\" class=\"text-muted ml-10\">\n          {{ t('rancherSupportBundle.download.notReady') }}\n        </span>\n      </div>\n    </div>\n\n    <ResourceTabs v-model=\"value\" :mode=\"'view'\">\n      <Tab name=\"clusters\" :label=\"t('rancherSupportBundle.clusters.label')\">\n        <SortableTable\n          :rows=\"clustersRows\"\n          :headers=\"clustersHeaders\"\n          key-field=\"cluster\"\n          :search=\"false\"\n          :paging=\"false\"\n        />\n      </Tab>\n    </ResourceTabs>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.labeled-input {\n  label {\n    display: block;\n    font-weight: bold;\n    margin-bottom: 5px;\n  }\n  div {\n    padding: 10px;\n    background: var(--input-bg);\n    border: 1px solid var(--input-border);\n    border-radius: 3px;\n  }\n}\n</style>\n"],"mappings":"AACA,OAAAA,YAAA;AACA,OAAAC,GAAA;AACA,OAAAC,aAAA;AACA,OAAAC,MAAA;AAEA;EACAC,IAAA;EACAC,UAAA;IACAL,YAAA;IACAC,GAAA;IACAC,aAAA;IACAC;EACA;EACAG,KAAA;IACAC,KAAA;MACAC,IAAA,EAAAC,MAAA;MACAC,QAAA;IACA;EACA;EACAC,QAAA;IACAC,gBAAA;MACA,QACA;QACAR,IAAA;QACAS,QAAA;QACAN,KAAA;MACA,EACA;IACA;IACAO,aAAA;MACA,aAAAP,KAAA,CAAAQ,IAAA,CAAAC,QAAA,QAAAC,GAAA,CAAAC,OAAA;QAAAA;MAAA;IACA;IACAC,YAAA;MAAA,IAAAC,kBAAA;MACA,SAAAA,kBAAA,QAAAb,KAAA,CAAAc,MAAA,cAAAD,kBAAA,uBAAAA,kBAAA,CAAAE,KAAA;IACA;IACAC,YAAA;MAAA,IAAAC,qBAAA;MACA;MACA;MACA,MAAAC,SAAA,QAAAlB,KAAA,CAAAmB,QAAA,CAAAD,SAAA;MACA,MAAAE,WAAA,WAAApB,KAAA,CAAAmB,QAAA,CAAAtB,IAAA;MACA,MAAAwB,SAAA,KAAAJ,qBAAA,QAAAK,MAAA,CAAAC,OAAA,gCAAAN,qBAAA,uBAAAA,qBAAA,CAAAO,EAAA;MAEA,wBAAAH,SAAA,sBAAAH,SAAA,aAAAE,WAAA;IACA;EACA;EACAK,OAAA;IACAC,eAAA;MACA,SAAAd,WAAA;QACAe,MAAA,CAAAC,QAAA,CAAAC,IAAA,QAAAb,WAAA;MACA;IACA;EACA;AACA","ignoreList":[]}]}